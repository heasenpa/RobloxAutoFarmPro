-- Auto Farm Fix V3 - Mobile Friendly
-- By GPT

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

-- ‚öôÔ∏è C·∫•u h√¨nh
local Config = {
    ScanDelay = 0.15, -- Th·ªùi gian qu√©t l·∫°i item
    Speed = 50,       -- T·ªëc ƒë·ªô bay
    PickupRange = 3,  -- Kho·∫£ng c√°ch ƒë·ªÉ nh·∫∑t
    NameKeys = {"BeachBall", "Coin"} -- T√™n item mu·ªën farm
}

local farming = true
local items = {}
local itemNames = {}

-- üñ• HUD
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.ResetOnSpawn = false

local hud = Instance.new("TextLabel", gui)
hud.Size = UDim2.new(0, 250, 0, 60)
hud.Position = UDim2.new(0, 10, 0, 10)
hud.BackgroundTransparency = 0.3
hud.BackgroundColor3 = Color3.new(0, 0, 0)
hud.TextColor3 = Color3.new(1, 1, 1)
hud.TextScaled = true
hud.Text = "AutoFarm: ON"

local listHud = Instance.new("TextLabel", gui)
listHud.Size = UDim2.new(0, 300, 0, 200)
listHud.Position = UDim2.new(0, 10, 0, 80)
listHud.BackgroundTransparency = 0.3
listHud.BackgroundColor3 = Color3.new(0, 0, 0)
listHud.TextColor3 = Color3.new(1, 1, 1)
listHud.TextScaled = false
listHud.TextWrapped = true
listHud.TextYAlignment = Enum.TextYAlignment.Top
listHud.Text = "Items Found:\n"

-- üõ° Anti AFK
player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

-- üö™ Noclip
RunService.Stepped:Connect(function()
    if character then
        for _, part in ipairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end)

-- üì¶ Theo d√µi item
local function trackItem(obj)
    if obj:IsA("BasePart") then
        local name = obj.Name
        if not table.find(itemNames, name) then
            table.insert(itemNames, name)
            listHud.Text = "Items Found:\n" .. table.concat(itemNames, "\n")
        end
        for _, key in ipairs(Config.NameKeys) do
            if string.find(string.lower(name), string.lower(key)) then
                table.insert(items, obj)
                obj.AncestryChanged:Connect(function(_, parent)
                    if not parent then
                        for i, v in ipairs(items) do
                            if v == obj then
                                table.remove(items, i)
                                break
                            end
                        end
                    end
                end)
                break
            end
        end
    end
end

-- Qu√©t ban ƒë·∫ßu
for _, v in ipairs(Workspace:GetDescendants()) do
    trackItem(v)
end
Workspace.DescendantAdded:Connect(trackItem)

-- üéØ L·∫•y item g·∫ßn nh·∫•t
local function getClosest()
    local closest, dist
    for _, obj in ipairs(items) do
        if obj and obj.Parent then
            local d = (hrp.Position - obj.Position).Magnitude
            if not dist or d < dist then
                closest, dist = obj, d
            end
        end
    end
    return closest, dist
end

-- üöÄ Auto Farm Loop
task.spawn(function()
    while task.wait(Config.ScanDelay) do
        if farming then
            local target, dist = getClosest()
            if target then
                local dir = (target.Position - hrp.Position).Unit
                hrp.Velocity = dir * Config.Speed
                if dist <= Config.PickupRange then
                    pcall(function()
                        firetouchinterest(hrp, target, 0)
                        firetouchinterest(hrp, target, 1)
                    end)
                end
            else
                hrp.Velocity = Vector3.zero
            end
        else
            hrp.Velocity = Vector3.zero
        end
    end
end)

-- ‚å®Ô∏è Toggle ON/OFF
game:GetService("UserInputService").InputBegan:Connect(function(input, gp)
    if not gp and input.KeyCode == Enum.KeyCode.G then
        farming = not farming
        hud.Text = "AutoFarm: " .. (farming and "ON" or "OFF")
    end
end)
