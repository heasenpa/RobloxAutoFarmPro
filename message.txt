-- AutoFarm Smooth Fly (Mobile Codex Friendly)
-- by ChatGPT

-- GUI nhỏ gọn
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local Button = Instance.new("TextButton")

ScreenGui.Parent = game:GetService("CoreGui")
Frame.Size = UDim2.new(0,150,0,60)
Frame.Position = UDim2.new(0,10,0,200)
Frame.BackgroundColor3 = Color3.fromRGB(40,40,40)
Frame.Parent = ScreenGui

Button.Size = UDim2.new(1,0,1,0)
Button.BackgroundColor3 = Color3.fromRGB(80,170,80)
Button.TextColor3 = Color3.new(1,1,1)
Button.Font = Enum.Font.SourceSansBold
Button.Text = "Start Farm"
Button.Parent = Frame

-- Script farm
local RunService = game:GetService("RunService")
local Tweening = false
local connection

-- Tạo part bay
local flyPart = Instance.new("Part")
flyPart.Size = Vector3.new(2,1,2)
flyPart.Anchored = true
flyPart.Transparency = 1
flyPart.CanCollide = false
flyPart.Parent = workspace

local root = game.Players.LocalPlayer.Character:WaitForChild("HumanoidRootPart")
root.CFrame = root.CFrame + Vector3.new(0,3,0)
local weld = Instance.new("WeldConstraint")
weld.Part0 = flyPart
weld.Part1 = root
weld.Parent = flyPart

-- Hàm bay mượt tới target
local function smoothFlyTo(targetPos)
    if connection then connection:Disconnect() end
    connection = RunService.Heartbeat:Connect(function(dt)
        local currentPos = flyPart.Position
        local direction = (targetPos - currentPos)
        local distance = direction.Magnitude
        if distance < 4 then
            connection:Disconnect()
        else
            local move = direction.Unit * (60 * dt) -- tốc độ
            flyPart.CFrame = CFrame.new(currentPos + move)
        end
    end)
end

-- Hàm tìm coin gần nhất
local function getNearestCoin()
    local nearest, dist = nil, math.huge
    for _,v in pairs(workspace:GetDescendants()) do
        if v:IsA("MeshPart") and v.Name == "Coin" then
            local d = (root.Position - v.Position).Magnitude
            if d < dist then
                nearest = v
                dist = d
            end
        end
    end
    return nearest
end

-- Vòng farm
local function startFarm()
    Tweening = true
    while Tweening do
        local coin = getNearestCoin()
        if coin then
            smoothFlyTo(coin.Position + Vector3.new(0,3,0))
        end
        task.wait(1)
    end
end

local function stopFarm()
    Tweening = false
    if connection then connection:Disconnect() end
end

-- Nút bấm
local farming = false
Button.MouseButton1Click:Connect(function()
    if not farming then
        farming = true
        Button.Text = "Stop Farm"
        Button.BackgroundColor3 = Color3.fromRGB(200,80,80)
        startFarm()
    else
        farming = false
        Button.Text = "Start Farm"
        Button.BackgroundColor3 = Color3.fromRGB(80,170,80)
        stopFarm()
    end
end)
