-- AutoFarm Smooth Fly (Heartbeat version, no tele)
-- by ChatGPT

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local root = LocalPlayer.Character:WaitForChild("HumanoidRootPart")

-- GUI
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local Button = Instance.new("TextButton")

ScreenGui.Parent = game:GetService("CoreGui")
Frame.Size = UDim2.new(0,150,0,60)
Frame.Position = UDim2.new(0,10,0,200)
Frame.BackgroundColor3 = Color3.fromRGB(40,40,40)
Frame.Parent = ScreenGui

Button.Size = UDim2.new(1,0,1,0)
Button.BackgroundColor3 = Color3.fromRGB(80,170,80)
Button.TextColor3 = Color3.new(1,1,1)
Button.Font = Enum.Font.SourceSansBold
Button.Text = "Start Farm"
Button.Parent = Frame

-- AutoFarm logic
local farming = false
local flyConn

local function getNearestCoin()
    local nearest, dist = nil, math.huge
    for _,v in pairs(workspace:GetDescendants()) do
        if v:IsA("MeshPart") and v.Name == "Coin" then
            local d = (root.Position - v.Position).Magnitude
            if d < dist then
                nearest = v
                dist = d
            end
        end
    end
    return nearest
end

local function smoothFlyTo(targetPos)
    if flyConn then flyConn:Disconnect() end
    flyConn = RunService.Heartbeat:Connect(function(dt)
        if not farming then flyConn:Disconnect() return end
        if not root or not root.Parent then return end

        local currentPos = root.Position
        local direction = (targetPos - currentPos)
        local distance = direction.Magnitude
        if distance < 4 then
            flyConn:Disconnect()
        else
            local move = direction.Unit * (60 * dt) -- speed 60
            root.CFrame = CFrame.new(currentPos + move)
        end
    end)
end

local function startFarm()
    farming = true
    while farming do
        local coin = getNearestCoin()
        if coin then
            smoothFlyTo(coin.Position + Vector3.new(0,3,0))
        end
        task.wait(0.5)
    end
end

local function stopFarm()
    farming = false
    if flyConn then flyConn:Disconnect() end
end

Button.MouseButton1Click:Connect(function()
    if not farming then
        Button.Text = "Stop Farm"
        Button.BackgroundColor3 = Color3.fromRGB(200,80,80)
        startFarm()
    else
        Button.Text = "Start Farm"
        Button.BackgroundColor3 = Color3.fromRGB(80,170,80)
        stopFarm()
    end
end)
